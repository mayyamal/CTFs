#!/bin/bash

python -c 'print("errantis voluntas nulla est"+"\x00")' | ./main.elf

# in the read_sane_line() function, i am entering the "errantis voluntas nulla est" (without the dot)
# plus a null character (the length returned by the function is 28 = dst-buf = "errantis voluntas nulla est" + 2 null chars, one added by the function))
# in the main, the first check passes since passlen!=0
# second check passes (both values are 28, passlen = dst-buf is also 28 because of two null chars)
# strncmp passes because now we are comparing 27 characters (so the dot is not compared), since the string is shortened by the entered null